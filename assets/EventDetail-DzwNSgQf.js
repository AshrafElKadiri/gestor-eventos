import{m as h,r as l,n as p,u as v,l as g,h as c,j as e}from"./index-BJgpdJ3D.js";import{a as b,b as j,i as f,r as y}from"./eventService-C5fvLD1m.js";function w(){const{id:n}=h(),[t,m]=l.useState(null),[i,o]=l.useState([]),[x,d]=l.useState(!1),a=p(s=>s.auth.user),{t:r}=v();l.useEffect(()=>{n&&(b(n).then(s=>{m(s),g("Evento cargado",s)}).catch(s=>c("Error al cargar evento",s)),j(n).then(o).catch(s=>c("Error al obtener registros",s)),a!=null&&a.uid&&f(n,a.uid).then(d).catch(s=>c("Error al verificar registro del usuario",s)))},[n,a==null?void 0:a.uid]);const u=async()=>{if(!a){alert("Debes iniciar sesión para registrarte.");return}if(i.length>=t.capacity){alert("Este evento ha alcanzado su capacidad máxima.");return}try{await y(n,a),o([...i,{email:a.email,timestamp:new Date}]),d(!0),g("Usuario registrado en evento",{eventId:n,user:a}),alert("¡Te has registrado con éxito!")}catch(s){c("Error al registrar usuario en evento",s),alert("Ocurrió un error. Intenta de nuevo.")}};return t?e.jsxs("div",{className:"p-6 max-w-4xl mx-auto bg-white rounded-xl shadow-md",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600",children:t.date}),t.imageUrl&&e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full max-h-64 object-cover rounded-lg mt-4 mb-6"}),e.jsx("p",{className:"mb-2 text-gray-700 whitespace-pre-line",children:t.description}),e.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["📍 ",t.location]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[r("event.category"),": ",t.category]}),e.jsxs("p",{className:"mb-4 text-gray-700",children:[e.jsxs("strong",{children:[r("event.capacity"),":"]})," ",t.capacity," ",r("event.attendees"),e.jsx("br",{}),e.jsxs("strong",{children:[r("event.registered"),":"]})," ",i.length]}),a?x?e.jsx("p",{className:"text-green-600 font-semibold",children:r("event.alreadyRegistered")}):i.length>=t.capacity?e.jsx("p",{className:"text-red-500 font-semibold",children:r("event.full")}):e.jsx("button",{onClick:u,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition",children:r("event.join")}):e.jsx("p",{className:"text-sm text-gray-600 italic",children:r("event.loginToRegister")})]}):e.jsx("div",{className:"p-6 text-center text-gray-500",children:r("event.loading")})}export{w as default};
